# Система управления банковскими картами

REST API для управления банковскими картами.

## Технологии

- Java 17
- Spring Boot 3.3.0
- Spring Security + JWT
- PostgreSQL
- Liquibase
- Docker & Docker Compose
- Swagger/OpenAPI

## Старт
### Предварительные требования

- Java 17+
- Docker и Docker Compose
- Git
- Maven

1) Клонируйте репозиторий:
``` bash
git clone https://github.com/Kkjss90/Bank_REST-main.git
cd Bank_REST-main
```
2) Создайте jar-файл
``` bash
mvn install -DskipTests
```
3) Запустите докер контейнер
``` bash
docker-compose up -d
```
Приложение будет доступно по адресу на порту: 8080 (для работы с приложением использовать http://localhost:8080/swagger-ui.html)

## Тестовые учетные записи

После запуска приложения доступны следующие тестовые пользователи:

### Администратор:

- Логин: admin
- Пароль: admin1234
- Права: полный доступ

### Обычные пользователи:

- Логин: user1 / Пароль: user12345678
- Логин: user12 / Пароль: user12345678
- Права: ограниченный доступ (всё, кроме администрирования)

## API Endpoints

### Аутентификация

- POST ```/api/auth/sign-up``` - регистрация нового пользователя
- POST ```/api/auth/sign-in``` - вход в систему, получение JWT токена

### Карты

- GET ```/api/cards/my-cards``` - получение списка своих карт
- GET ```/api/cards/my-cards/active``` - получение списка своих активных карт
- GET ```/api/cards/balance``` - просмотр баланса карты
- POST ```/api/cards/create``` - создание новой карты
- POST ```/api/cards/block/{cardId}```- блокировка карты
- POST ```/api/cards/transfer``` - перевод между картами

### Администрирование

- GET ```/api/cards/admin/all-cards``` - получение списка всех карт (только для админа)
- POST ```/api/cards/admin/create/{username}``` - создание карты для пользователя (только для админа)
- DELETE ```/api/cards/admin/delete/{cardId}``` - удаление карты (только для админа)
- POST ```/api/cards/admin/update/{cardId}``` - активация карты (только для админа)
- PUT ```/api/admin/user/create``` - создание пользователя (только для админа)
- DELETE ```/api/admin/user/delete/{userId}``` - удаление пользователя (только для админа)
- PATCH ```/api/admin/user/role-update/{user_id}``` - изменение пользователя (только для админа)

Полная документация API доступна через Swagger UI: http://localhost:8080/swagger-ui.html

## Основные функции

### Управление пользователями:

- Регистрация
- Аутентификация (JWT)
- Разграничение прав (USER/ADMIN)

### Управление картами:

- Создание карт
- Просмотр своих карт (всех или только активных)
- Просмотр баланса
- Блокировка карт
- Переводы между картами

### Безопасность:

- JWT аутентификация
- Шифрование номеров карт
- Разграничение входных и выходных запросов

## Разработка

### База данных

Миграции базы данных управляются через Liquibase. Файлы миграций находятся в:

```src/main/resources/db/migration/```

### Тестирование

Запуск тестов:

``` bash
mvn test
```

### Безопасность

- Пароли хешируются с использованием BCrypt
- Номера карт шифруются перед сохранением в базу и отдаются пользователю в зашифрованном виде
- Все API-endpoints защищены Spring Security
- Используется JWT для аутентификации
